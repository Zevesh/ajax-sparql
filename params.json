{
  "name": "Ajax-sparql",
  "tagline": "A Polymer component to automatize an SPARQL request based in a well-formed query.",
  "body": "## &lt;ajax-sparql&gt;\r\n`ajax-sparql` is a simple component that automatizes the creation of a request for an SPARQL site just by taking an SPARQL query. That allows the code to be more readable, because you can see the original query instead of the resulting url. It can also be used to create queries based on the content of a variable, being not necessary to know the data at coding time. \r\n\r\nWhen creating an instance of this component, we need to know the URL of the site where we will execute the query and the query itself. Sometimes we also need the graph inside the site, but usually it is optional.\r\n\r\n\r\n### Declaration of the component.\r\nWhen creating an element of `ajax-sparql` the properties `url` and `query` are always required, whereas `graph` is optional. There is another point to have in mind. This component have no `on-response` attribute, so the treatment of the data must be done manually. To achieve this, first we have to give it an `id` to simplify the later access. \r\n\r\nExample:\r\n```\r\n<ajax-sparql \r\nid=\"request\"\r\nurl=\"http://opendata.caceres.es/sparql/\"\r\ngraph=\"http://opendata.caceres.es/recurso/salud/centros/\"\r\nquery=\"select ?name ?latitude ?longitude where{\r\n  ?URI a schema:MedicalOrganization.\r\n  ?URI rdfs:label ?name.\r\n  ?URI geo:lat ?latitude.\r\n  ?URI geo:long ?longitude. \r\n  }\">\r\n</ajax-sparql>\r\n```\r\n\r\nThe `query` property admits various formats: in a single line, in multiple lines, with keywords in upper or lower case... Choose wherever you prefer to make your code more readable, although we recommend the lower-case, multiple-lines format. In the examples below the query is smaller just for show up purpose, but it works with any query you need.\r\n\r\nExample:\r\n```\r\n<ajax-sparql \r\nid=\"request\"\r\nurl=\"http://opendata.caceres.es/sparql/\"\r\ngraph=\"http://opendata.caceres.es/recurso/salud/centros/\"\r\nquery=\"select ?name where{ ?URI a schema:MedicalOrganization. ?URI rdfs:label ?name.}\">\r\n</ajax-sparql>\r\n\r\n<ajax-sparql \r\nid=\"request\"\r\nurl=\"http://opendata.caceres.es/sparql/\"\r\ngraph=\"http://opendata.caceres.es/recurso/salud/centros/\"\r\nquery=\"SELECT ?name WHERE{ ?URI a schema:MedicalOrganization. ?URI rdfs:label ?name.}\">\r\n</ajax-sparql>\r\n```\r\n\r\n### Retrieval of results.\r\nAs we are making an asynchronous request, the data will not be inmediately available. Thanks to the `id` we give to each element, it is easy to access each one in a separate way. To retrieve the data you can use some kind of observer or any other method you prefer, but here we present two options:\r\n\r\n* __If our element is included inside another.__  Launch a function in the ready that makes asynchronous calls until some result is received.\r\n\r\nExample:\r\n```\r\n<dom-module id=\"external-component\">\r\n  <template>\r\n      <ajax-sparql \r\n      id=\"request\"\r\n      url=\"http://opendata.caceres.es/sparql/\"\r\n      graph=\"http://opendata.caceres.es/recurso/salud/centros/\"\r\n      query=\"select ?name where{ ?URI a schema:MedicalOrganization. ?URI rdfs:label ?name.}\">\r\n      </ajax-sparql>\r\n  </template>\r\n</dom-module>  \r\n\r\n<script>\r\n  Polymer({\r\n    is: 'external-component',\r\n    \r\n    ready: function(){\r\n      this.async(this.checkResults, 300);\r\n    },\r\n\r\n    checkResults: function(){\r\n      var result = this.$.request.getResults();\r\n      if (result == undefined){\r\n        this.async(this.checkResults, 300);\r\n      } else {\r\n        //Do what you need with the results:\r\n        console.log(result);\r\n      }\r\n    }\r\n  });\r\n</script>\r\n```\r\n\r\n* __If the `ajax-sparql` element is outside any component.__ Create an interval that periodically checks if the there is some response. In affirmative case, stop the interval.\r\n\r\nExample:\r\n```\r\n<ajax-sparql \r\nid=\"request\"\r\nurl=\"http://opendata.caceres.es/sparql/\"\r\ngraph=\"http://opendata.caceres.es/recurso/salud/centros/\"\r\nquery=\"select ?name where{ ?URI a schema:MedicalOrganization. ?URI rdfs:label ?name.}\">\r\n</ajax-sparql>\r\n\r\n<script>\r\n  var interval = setInterval(checkResult, 300);\r\n\r\n  function checkResult(){\r\n      var result = document.getElementById(\"request\").getResults();\r\n      if (result != undefined){\r\n        clearInterval(interval);\r\n       \r\n        //Do what you need with the results:\r\n        console.log(result);\r\n      }\r\n  }\r\n</script>\r\n```",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}